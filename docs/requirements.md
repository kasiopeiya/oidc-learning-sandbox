# OIDC学習サンドボックス 要件定義

## アプリ概要

- **目的**: OIDC認証フロー(認可コードフロー)をRP(Relying Party)として実装する際の動作確認・学習環境を提供する
- **解決したい課題**:
  - OPの設定が難しく、手軽にOIDC実装を試せない
  - 実際に動かさないとOIDCの詳細(State、Nonce、PKCEなど)を理解しにくい
- **ターゲット**: OIDCを学習したいソフトウェアエンジニア(主に自分自身)
- **規模**: 個人開発、学習用途、ユーザー数1〜3人想定

## 技術スタック

- **言語**: TypeScript(CDK、Lambda、フロントエンド全て統一)
- **インフラ**: AWS CDK
- **認証**: Amazon Cognito(OP)
- **バックエンド**: API Gateway + Lambda
- **フロントエンド**: S3 + CloudFront

## MVP機能(最小構成)

- **インフラ自動構築**: AWS CDKでワンコマンド環境構築
- **OP機能**: Amazon Cognitoでの認証プロバイダー設定
- **RP実装(バックエンド)**: 認可コードフローの実装
  - 認可リクエスト生成(State、Nonce、PKCE対応)
  - 認可コードからのコールバック受信
  - トークンエンドポイントへのトークン交換リクエスト
  - IDトークン検証(署名検証、Nonce検証など)
- **RP実装(フロントエンド)**: 最小限UI
  - トップ画面: 「口座作成」ボタン
  - 認証後コールバック画面: 「認証成功しました」メッセージ + ユーザー情報表示
- **サンプルユースケース**: 銀行口座作成の入り口まで
  - 未認証状態で「口座作成」ボタンをクリック
  - OIDC認証フローへリダイレクト
  - 認証成功後、成功メッセージとユーザー情報を表示

## 将来機能

- **StateやNonceなどの管理をCookieからDynamoDBに変更**： よりセキュアなセッション管理方法に変更
- **実際の口座作成機能**: 認証後に口座番号を発行するなどの処理
- **認証フローログ可視化**: 各ステップ(認可リクエスト、トークン交換など)のパラメータやレスポンスをブラウザで確認
- **トークンデバッグUI**: IDトークン、アクセストークンをデコードして表示
- **テスト実装**:
  - 単体テスト: バックエンドのユーティリティ関数、エラーハンドリング
