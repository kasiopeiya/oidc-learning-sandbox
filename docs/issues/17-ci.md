# Issue #17: `/ci` ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã‚³ãƒãƒ³ãƒ‰å®Ÿè£…è¨ˆç”»

### é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- ğŸ“ Plan: [ci.md](../plan/ci.md)

## ğŸ“‚ ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ (Context)

> ClaudeãŒèª¿æŸ»ã‚’é–‹å§‹ã™ã‚‹èµ·ç‚¹ã¨ãªã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’æŒ‡å®šã—ã¾ã™

- `backend/eslint.config.mjs`
- `frontend/eslint.config.mjs`
- `.claude/skills/ci/SKILL.md`
- `.claude/agents/ci-runner/ci-runner.md`
- `backend/package.json`
- `frontend/package.json`

### èƒŒæ™¯ / ç›®çš„

ç¾åœ¨ã€ã‚³ãƒŸãƒƒãƒˆå‰ã‚„PRä½œæˆå‰ã«ã‚³ãƒ¼ãƒ‰å“è³ªã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹çµ±åˆçš„ãªã‚³ãƒãƒ³ãƒ‰ãŒã‚ã‚Šã¾ã›ã‚“ã€‚é–‹ç™ºè€…ã¯ä»¥ä¸‹ã‚’å€‹åˆ¥ã«å®Ÿè¡Œã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼š

- `npm run format:check` ï¼ˆPrettier ãƒã‚§ãƒƒã‚¯ï¼‰
- `npm run lint` ï¼ˆESLint - æœªè¨­å®šï¼‰
- `npm run type-check` ï¼ˆå‹ãƒã‚§ãƒƒã‚¯ - ã‚¹ã‚¯ãƒªãƒ—ãƒˆãªã—ï¼‰
- `npm test` ï¼ˆå˜ä½“ãƒ†ã‚¹ãƒˆï¼‰

ã“ã‚Œã¯éåŠ¹ç‡ã§ã€ãƒã‚§ãƒƒã‚¯æ¼ã‚Œã®ãƒªã‚¹ã‚¯ã‚‚ã‚ã‚Šã¾ã™ã€‚

**è§£æ±ºã—ãŸã„å•é¡Œ**:

1. **ESLint ãŒæœªè¨­å®š**: Backend ã« `lint` ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ã‚ã‚‹ãŒã€ESLint ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ãªã„
2. **å‹ãƒã‚§ãƒƒã‚¯ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒãªã„**: TypeScript ã®å‹ãƒã‚§ãƒƒã‚¯ã‚’å®Ÿè¡Œã™ã‚‹çµ±ä¸€çš„ãªæ–¹æ³•ãŒãªã„
3. **çµ±åˆ CI ã‚³ãƒãƒ³ãƒ‰ãŒãªã„**: é™çš„è§£æã¨ãƒ†ã‚¹ãƒˆã‚’ä¸€æ‹¬å®Ÿè¡Œã§ããªã„

**æœŸå¾…ã•ã‚Œã‚‹æˆæœ**:

- `/ci` ã‚³ãƒãƒ³ãƒ‰ä¸€ã¤ã§ã€å…¨ã¦ã®å“è³ªãƒã‚§ãƒƒã‚¯ï¼ˆé™çš„è§£æ + ãƒ†ã‚¹ãƒˆï¼‰ã‚’å®Ÿè¡Œ
- ã‚³ãƒŸãƒƒãƒˆå‰/PRå‰ã®å“è³ªæ‹…ä¿ã‚’è‡ªå‹•åŒ–
- ã‚¨ãƒ©ãƒ¼æ™‚ã¯è©³ç´°ãªä¿®æ­£ææ¡ˆã‚’è¡¨ç¤º
- æ—¢å­˜ã®é–‹ç™ºãƒ•ãƒ­ãƒ¼ã«çµ±åˆï¼ˆCLAUDE.md ã®é–‹ç™ºãƒ•ãƒ­ãƒ¼ Step 6.1, 6.2 ã® `/ci` éƒ¨åˆ†ï¼‰

- ãƒ©ãƒ™ãƒ«: ci, backend, frontend, eslint, test

### ã‚¹ã‚³ãƒ¼ãƒ— / ä½œæ¥­é …ç›®

#### æ¡ç”¨æŠ€è¡“: ESLint 9.x + Flat Config å½¢å¼ï¼ˆæœ€æ–°ï¼‰

**é¸å®šç†ç”±**:

- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã« ESLint ãŒæœªå°å…¥ã®ãŸã‚ã€æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’æ¡ç”¨
- ESLint 9.x ã§ã¯ `.eslintrc.js` ãŒéæ¨å¥¨ã€`eslint.config.mjs` (Flat Config) ãŒæ¨™æº–
- å‚è€ƒ: [ESLint 9 Flat config tutorial](https://dev.to/aolyang/eslint-9-flat-config-tutorial-2bm5), [How to Set Up ESLint 9 with Prettier in Node.js](https://medium.com/@madhan.gannarapu/how-to-set-up-eslint-9-with-prettier-in-node-js-flat-config-typescript-0eb1755f83cd)

**å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸**:

- Backend: `eslint`, `@eslint/js`, `typescript-eslint`, `globals`
- Frontend: `eslint`, `@eslint/js`, `typescript-eslint`, `globals`, `eslint-plugin-react`, `eslint-plugin-react-hooks`, `eslint-plugin-jsx-a11y`

#### å®Ÿè¡Œé †åºï¼ˆæ—©æœŸå¤±æ•—æˆ¦ç•¥ï¼‰

å„ãƒã‚§ãƒƒã‚¯ã‚’é †æ¬¡å®Ÿè¡Œã—ã€**æœ€åˆã®å¤±æ•—ã§å³åº§ã«åœæ­¢**:

1. **Prettier ãƒã‚§ãƒƒã‚¯** â†’ ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆé•åãŒã‚ã‚‹ã¨å¾Œç¶šã®ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒå›°é›£
2. **ESLint ãƒã‚§ãƒƒã‚¯** â†’ æ§‹æ–‡ã‚¨ãƒ©ãƒ¼ãƒ»ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¹ã‚¿ã‚¤ãƒ«é•å
3. **TypeScript å‹ãƒã‚§ãƒƒã‚¯** â†’ å‹å®‰å…¨æ€§ã®æ¤œè¨¼
4. **å˜ä½“ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ** â†’ æ©Ÿèƒ½æ¤œè¨¼

**è¨­è¨ˆåˆ¤æ–­**: ä¸¦åˆ—å®Ÿè¡Œã§ã¯ãªãé€æ¬¡å®Ÿè¡Œã‚’æ¡ç”¨

- ç†ç”±: æœ€åˆã®å¤±æ•—ã§åœæ­¢ã™ã‚‹ã“ã¨ã§ã€é–‹ç™ºè€…ã¯åŸºæœ¬çš„ãªå•é¡Œã‹ã‚‰æ®µéšçš„ã«ä¿®æ­£ã§ãã‚‹
- ä¾‹: ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚¨ãƒ©ãƒ¼ã‚’ä¿®æ­£ã—ã¦ã‹ã‚‰å‹ã‚¨ãƒ©ãƒ¼ã«å–ã‚Šçµ„ã‚€æ–¹ãŒåŠ¹ç‡çš„

#### Phase 1: ESLint è¨­å®šã®è¿½åŠ 

**1.1 Backend ã® ESLint è¨­å®š**

ä½œæˆã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«: `backend/eslint.config.mjs`

```javascript
import eslint from '@eslint/js'
import tseslint from 'typescript-eslint'
import globals from 'globals'

export default tseslint.config(
  eslint.configs.recommended,
  ...tseslint.configs.recommendedTypeChecked,
  {
    languageOptions: {
      ecmaVersion: 2022,
      sourceType: 'module',
      globals: {
        ...globals.node,
        ...globals.es2022
      },
      parserOptions: {
        project: './tsconfig.json',
        tsconfigRootDir: import.meta.dirname
      }
    },
    rules: {
      '@typescript-eslint/no-unused-vars': ['error', { argsIgnorePattern: '^_' }],
      '@typescript-eslint/explicit-function-return-type': 'off',
      '@typescript-eslint/no-explicit-any': 'warn'
    }
  },
  {
    ignores: ['dist', 'node_modules', '*.config.ts', '*.config.mjs', '**/*.test.ts']
  }
)
```

`backend/package.json` ã¸ã®è¿½åŠ :

- devDependencies: `eslint@^9.17.0`, `@eslint/js@^9.17.0`, `typescript-eslint@^8.19.1`, `globals@^15.14.0`
- scripts: `"type-check": "tsc --noEmit"`

**1.2 Frontend ã® ESLint è¨­å®š**

ä½œæˆã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«: `frontend/eslint.config.mjs`

```javascript
import eslint from '@eslint/js'
import tseslint from 'typescript-eslint'
import globals from 'globals'
import react from 'eslint-plugin-react'
import reactHooks from 'eslint-plugin-react-hooks'
import jsxA11y from 'eslint-plugin-jsx-a11y'

export default tseslint.config(
  eslint.configs.recommended,
  ...tseslint.configs.recommendedTypeChecked,
  react.configs.flat.recommended,
  react.configs.flat['jsx-runtime'],
  jsxA11y.flatConfigs.recommended,
  {
    plugins: {
      'react-hooks': reactHooks
    },
    languageOptions: {
      ecmaVersion: 2020,
      sourceType: 'module',
      globals: {
        ...globals.browser,
        ...globals.es2020
      },
      parserOptions: {
        ecmaFeatures: {
          jsx: true
        },
        project: './tsconfig.json',
        tsconfigRootDir: import.meta.dirname
      }
    },
    settings: {
      react: {
        version: 'detect'
      }
    },
    rules: {
      ...reactHooks.configs.recommended.rules,
      '@typescript-eslint/no-unused-vars': ['error', { argsIgnorePattern: '^_' }],
      '@typescript-eslint/explicit-function-return-type': 'off',
      '@typescript-eslint/no-explicit-any': 'warn',
      'react-hooks/rules-of-hooks': 'error',
      'react-hooks/exhaustive-deps': 'warn'
    }
  },
  {
    ignores: [
      'dist',
      'node_modules',
      '*.config.ts',
      '*.config.mjs',
      '**/*.test.ts',
      '**/*.test.tsx'
    ]
  }
)
```

`frontend/package.json` ã¸ã®è¿½åŠ :

- devDependencies: `eslint@^9.17.0`, `@eslint/js@^9.17.0`, `typescript-eslint@^8.19.1`, `globals@^15.14.0`, `eslint-plugin-react@^7.37.3`, `eslint-plugin-react-hooks@^5.1.0`, `eslint-plugin-jsx-a11y@^6.10.2`
- scripts: `"lint": "eslint src --ext .ts,.tsx"`, `"lint:fix": "eslint src --ext .ts,.tsx --fix"`, `"type-check": "tsc --noEmit"`

#### Phase 2: `/ci` ã‚¹ã‚­ãƒ«ã¨ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®å®Ÿè£…

**2.1 ã‚¹ã‚­ãƒ«å®šç¾©ãƒ•ã‚¡ã‚¤ãƒ«**: `.claude/skills/ci/SKILL.md`

Backend ã¨ Frontend ã®é™çš„è§£æã¨å˜ä½“ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã€CI/CD ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã®ãƒ­ãƒ¼ã‚«ãƒ«å®Ÿè¡Œã‚’å¯èƒ½ã«ã™ã‚‹ã‚¹ã‚­ãƒ«ã€‚

å‡¦ç†å†…å®¹:

1. Prettier ã«ã‚ˆã‚‹ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆãƒã‚§ãƒƒã‚¯
2. ESLint ã«ã‚ˆã‚‹é™çš„è§£æï¼ˆBackend/Frontendï¼‰
3. TypeScript å‹ãƒã‚§ãƒƒã‚¯ï¼ˆBackend/Frontendï¼‰
4. å˜ä½“ãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆBackend/Frontendï¼‰
5. è©³ç´°ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ

**2.2 ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå®šç¾©ãƒ•ã‚¡ã‚¤ãƒ«**: `.claude/agents/ci-runner/ci-runner.md`

é™çš„è§£æã¨å˜ä½“ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã€è©³ç´°ã«åˆ†æãƒ»ãƒ¬ãƒãƒ¼ãƒˆã™ã‚‹å°‚é–€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã€‚

å®Ÿè¡Œãƒ—ãƒ­ã‚»ã‚¹:

- Phase 1: ç’°å¢ƒãƒã‚§ãƒƒã‚¯ï¼ˆnode_modules ã®å­˜åœ¨ç¢ºèªï¼‰
- Phase 2: Prettier ãƒã‚§ãƒƒã‚¯
- Phase 3: ESLint ãƒã‚§ãƒƒã‚¯ï¼ˆBackendï¼‰
- Phase 4: ESLint ãƒã‚§ãƒƒã‚¯ï¼ˆFrontendï¼‰
- Phase 5: TypeScript å‹ãƒã‚§ãƒƒã‚¯ï¼ˆBackendï¼‰
- Phase 6: TypeScript å‹ãƒã‚§ãƒƒã‚¯ï¼ˆFrontendï¼‰
- Phase 7: å˜ä½“ãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆBackendï¼‰
- Phase 8: å˜ä½“ãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆFrontendï¼‰
- Phase 9: æˆåŠŸãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ

å„ãƒã‚§ãƒƒã‚¯ã¯é †æ¬¡å®Ÿè¡Œã•ã‚Œã€**æœ€åˆã®å¤±æ•—ã§å³åº§ã«åœæ­¢**ã—ã¾ã™ã€‚

### ã‚´ãƒ¼ãƒ« / å®Œäº†æ¡ä»¶ï¼ˆAcceptance Criteriaï¼‰

- [ ] Backend ã® ESLint è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ`eslint.config.mjs`ï¼‰ã‚’ä½œæˆã—ã€å‹•ä½œç¢ºèª
- [ ] Frontend ã® ESLint è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ`eslint.config.mjs`ï¼‰ã‚’ä½œæˆã—ã€å‹•ä½œç¢ºèª
- [ ] `/ci` ã‚¹ã‚­ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ`.claude/skills/ci/SKILL.md`ï¼‰ã‚’ä½œæˆ
- [ ] CI Runner ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆï¼ˆ`.claude/agents/ci-runner/ci-runner.md`ï¼‰ã‚’ä½œæˆ
- [ ] `/ci` ã‚³ãƒãƒ³ãƒ‰ã§å…¨ãƒã‚§ãƒƒã‚¯ãŒé †æ¬¡å®Ÿè¡Œã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
- [ ] å„ãƒã‚§ãƒƒã‚¯å¤±æ•—æ™‚ã«é©åˆ‡ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¨ä¿®æ­£ææ¡ˆãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
- [ ] å…¨ãƒã‚§ãƒƒã‚¯æˆåŠŸæ™‚ã«æˆåŠŸãƒ¬ãƒãƒ¼ãƒˆãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª

### ãƒ†ã‚¹ãƒˆè¦³ç‚¹

#### 1. å„ã‚³ãƒãƒ³ãƒ‰ã®å€‹åˆ¥å®Ÿè¡Œ

```bash
# Prettier ãƒã‚§ãƒƒã‚¯
npm run format:check

# ESLint ãƒã‚§ãƒƒã‚¯ï¼ˆBackendï¼‰
cd backend && npm run lint

# ESLint ãƒã‚§ãƒƒã‚¯ï¼ˆFrontendï¼‰
cd frontend && npm run lint

# TypeScript å‹ãƒã‚§ãƒƒã‚¯ï¼ˆBackendï¼‰
cd backend && npm run type-check

# TypeScript å‹ãƒã‚§ãƒƒã‚¯ï¼ˆFrontendï¼‰
cd frontend && npm run type-check

# å˜ä½“ãƒ†ã‚¹ãƒˆï¼ˆBackendï¼‰
cd backend && npm test

# å˜ä½“ãƒ†ã‚¹ãƒˆï¼ˆFrontendï¼‰
cd frontend && npm test
```

#### 2. `/ci` ã‚³ãƒãƒ³ãƒ‰ã®å®Ÿè¡Œ

å…¨ãƒã‚§ãƒƒã‚¯ãŒæˆåŠŸã™ã‚‹çŠ¶æ…‹ã§ `/ci` ã‚’å®Ÿè¡Œã—ã€`âœ… CI Passed!` ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèªã€‚

#### 3. ã‚¨ãƒ©ãƒ¼ã‚±ãƒ¼ã‚¹ã®ç¢ºèª

ä»¥ä¸‹ã®ã‚¨ãƒ©ãƒ¼ã‚±ãƒ¼ã‚¹ã§é©åˆ‡ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª:

**ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ 1: Prettier ãƒã‚§ãƒƒã‚¯å¤±æ•—**

- ãƒ•ã‚¡ã‚¤ãƒ«ã®æœ«å°¾ã«ã‚¹ãƒšãƒ¼ã‚¹ã‚’è¿½åŠ 
- æœŸå¾…çµæœ: Prettier ãƒã‚§ãƒƒã‚¯ã§å¤±æ•—ã€`npm run format` ã®å®Ÿè¡Œã‚’ææ¡ˆ

**ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ 2: ESLint ãƒã‚§ãƒƒã‚¯å¤±æ•—**

- æœªä½¿ç”¨å¤‰æ•°ã‚’è¿½åŠ 
- æœŸå¾…çµæœ: ESLint ãƒã‚§ãƒƒã‚¯ã§å¤±æ•—ã€ãƒ«ãƒ¼ãƒ«åã¨ `npm run lint:fix` ã®å®Ÿè¡Œã‚’ææ¡ˆ

**ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ 3: TypeScript å‹ãƒã‚§ãƒƒã‚¯å¤±æ•—**

- å‹ã‚¨ãƒ©ãƒ¼ã‚’è¿½åŠ ï¼ˆä¾‹: æ–‡å­—åˆ—ã‚’æ•°å€¤ã«ä»£å…¥ï¼‰
- æœŸå¾…çµæœ: å‹ãƒã‚§ãƒƒã‚¯ã§å¤±æ•—ã€ã‚¨ãƒ©ãƒ¼ç®‡æ‰€ï¼ˆãƒ•ã‚¡ã‚¤ãƒ«å:è¡Œç•ªå·ï¼‰ã¨åŸå› ã‚’è¡¨ç¤º

**ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ 4: å˜ä½“ãƒ†ã‚¹ãƒˆå¤±æ•—**

- ãƒ†ã‚¹ãƒˆã®æœŸå¾…å€¤ã‚’å¤‰æ›´
- æœŸå¾…çµæœ: ãƒ†ã‚¹ãƒˆã§å¤±æ•—ã€å¤±æ•—ã—ãŸãƒ†ã‚¹ãƒˆåã¨ã‚¨ãƒ©ãƒ¼å†…å®¹ã‚’è¡¨ç¤º

ï¼ˆå¿…è¦ãªã‚‰ï¼‰è¦ç¢ºèªäº‹é …:

- ï¼ˆãªã—ï¼‰
